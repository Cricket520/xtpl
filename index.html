<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>xtpl by kissyteam</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>xtpl</h1>
        <h2>xtpl template engine</h2>
        <a href="https://github.com/kissyteam/xtpl" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h2>
<a name="%E5%9F%BA%E6%9C%AC-api" class="anchor" href="#%E5%9F%BA%E6%9C%AC-api"><span class="octicon octicon-link"></span></a>基本 api</h2>

<h3>
<a name="class" class="anchor" href="#class"><span class="octicon octicon-link"></span></a>Class</h3>

<p>XTemplate/XTemplateRuntime</p>

<p>构造器参数</p>

<table>
<thead><tr>
<th>name</th>
        <th>type</th>
        <th>description</th>
    </tr></thead>
<tbody>
<tr>
<td>content</td>
        <td>String</td>
        <td>模板字符串</td>
    </tr>
<tr>
<td>config</td>
            <td>Object</td>
            <td>
            对象属性含义：
            <table>
<thead><tr>
<th>name</th>
                        <th>type</th>
                        <th>description</th>
                    </tr></thead>
<tbody>
<tr>
<td>name</td>
                        <td>String</td>
                        <td>模板名字，用于编译时报错</td>
                    </tr>
<tr>
<td>commands</td>
                        <td>Object</td>
                        <td>命令定义，详见下文</td>
                        </tr>
</tbody>
</table>
</td>
        </tr>
</tbody>
</table><h3>
<a name="methods" class="anchor" href="#methods"><span class="octicon octicon-link"></span></a>Methods</h3>

<p>String render(data:Object, callback:Function): 渲染数据，参数含义如下</p>

<table>
<thead><tr>
<th>name</th>
        <th>type</th>
        <th>description</th>
    </tr></thead>
<tbody>
<tr>
<td>data</td>
        <td>Object</td>
        <td>数据对象</td>
    </tr>
<tr>
<td>callback</td>
            <td>Function</td>
            <td>完毕回调，第一个参数为 error，第二个参数为渲染结果。如果不提供，同步命令下 render 返回渲染结果。</td>
        </tr>
</tbody>
</table><h2>
<a name="%E6%B5%8F%E8%A7%88%E5%99%A8%E7%AB%AF%E4%BD%BF%E7%94%A8" class="anchor" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%AB%AF%E4%BD%BF%E7%94%A8"><span class="octicon octicon-link"></span></a>浏览器端使用</h2>

<h3>
<a name="%E6%9C%AA%E9%A2%84%E7%BC%96%E8%AF%91" class="anchor" href="#%E6%9C%AA%E9%A2%84%E7%BC%96%E8%AF%91"><span class="octicon octicon-link"></span></a>未预编译</h3>

<div class="highlight highlight-javascript"><pre><span class="nx">KISSY</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'xtemplate'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">S</span><span class="p">,</span><span class="nx">XTemplate</span><span class="p">){</span>
  <span class="k">new</span> <span class="nx">XTemplate</span><span class="p">(</span><span class="s1">'{{x}}'</span><span class="p">,{</span><span class="nx">name</span><span class="o">:</span> <span class="s1">'x-tpl'</span><span class="p">}).</span><span class="nx">render</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span><span class="mi">1</span><span class="p">},</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span><span class="nx">z</span><span class="p">){</span>
    <span class="c1">// z=&gt;1</span>
  <span class="p">});</span>
<span class="p">})</span>
</pre></div>

<h3>
<a name="%E9%A2%84%E7%BC%96%E8%AF%91" class="anchor" href="#%E9%A2%84%E7%BC%96%E8%AF%91"><span class="octicon octicon-link"></span></a>预编译</h3>

<pre><code>npm install kissy@5.0.0-alpha.2 -g
kissy-xtemplate -p x/   // x/ 为模板文件目录，后缀为 -xtpl.html
</code></pre>

<div class="highlight highlight-javascript"><pre><span class="nx">KISSY</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'xtemplate/runtime,a/b-xtpl'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">S</span><span class="p">,</span><span class="nx">XTemplateRuntime</span><span class="p">,</span><span class="nx">bXtpl</span><span class="p">){</span>
  <span class="k">new</span> <span class="nx">XTemplateRuntime</span><span class="p">(</span><span class="nx">bXtpl</span><span class="p">).</span><span class="nx">render</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span><span class="mi">1</span><span class="p">},</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span><span class="nx">z</span><span class="p">){</span>
    <span class="c1">// z=&gt;1</span>
  <span class="p">});</span>
<span class="p">})</span>
</pre></div>

<h2>
<a name="node-%E4%B8%8B%E4%BD%BF%E7%94%A8" class="anchor" href="#node-%E4%B8%8B%E4%BD%BF%E7%94%A8"><span class="octicon octicon-link"></span></a>node 下使用</h2>

<p>包：<a href="https://www.npmjs.org/package/xtpl">https://www.npmjs.org/package/xtpl</a></p>

<p>express 下使用:</p>

<div class="highlight highlight-javascript"><pre><span class="nx">app</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">"view engine"</span><span class="p">,</span> <span class="s2">"xtpl"</span><span class="p">);</span>
</pre></div>

<p>模板文件全部为 xtpl 后缀，目录规范和渲染同 express</p>

<h2>
<a name="%E8%AF%AD%E6%B3%95" class="anchor" href="#%E8%AF%AD%E6%B3%95"><span class="octicon octicon-link"></span></a>语法</h2>

<h3>
<a name="%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B" class="anchor" href="#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B"><span class="octicon octicon-link"></span></a>基本类型</h3>

<p>支持 true false null undefined number string</p>

<h3>
<a name="%E5%AD%97%E9%9D%A2%E6%A8%A1%E5%BC%8F" class="anchor" href="#%E5%AD%97%E9%9D%A2%E6%A8%A1%E5%BC%8F"><span class="octicon octicon-link"></span></a>字面模式</h3>

<pre><code>{{%

{{x}}

%}}  // =&gt; {{x}}
</code></pre>

<h3>
<a name="%E6%B3%A8%E9%87%8A" class="anchor" href="#%E6%B3%A8%E9%87%8A"><span class="octicon octicon-link"></span></a>注释</h3>

<pre><code>{{! zhu shi }}
</code></pre>

<h3>
<a name="%E5%8F%98%E9%87%8F%E6%B8%B2%E6%9F%93" class="anchor" href="#%E5%8F%98%E9%87%8F%E6%B8%B2%E6%9F%93"><span class="octicon octicon-link"></span></a>变量渲染</h3>

<p>转义：</p>

<pre><code>{{x}}
</code></pre>

<p>非转义:</p>

<pre><code>{{{x}}}
</code></pre>

<h3>
<a name="%E6%94%AF%E6%8C%81%E5%8F%98%E9%87%8F%E5%B1%9E%E6%80%A7%E8%8E%B7%E5%8F%96" class="anchor" href="#%E6%94%AF%E6%8C%81%E5%8F%98%E9%87%8F%E5%B1%9E%E6%80%A7%E8%8E%B7%E5%8F%96"><span class="octicon octicon-link"></span></a>支持变量属性获取</h3>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">y</span><span class="o">:</span> <span class="mi">1</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">z</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">q</span><span class="o">:</span> <span class="mi">1</span>
<span class="p">};</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="s1">'q'</span><span class="p">;</span>
</pre></div>

<pre><code>{{x.y}} // 1
{{y[1]}} // 2
{{z[x]}} // 1
</code></pre>

<h3>
<a name="%E8%B0%83%E7%94%A8%E5%8F%98%E9%87%8F%E6%96%B9%E6%B3%95" class="anchor" href="#%E8%B0%83%E7%94%A8%E5%8F%98%E9%87%8F%E6%96%B9%E6%B3%95"><span class="octicon octicon-link"></span></a>调用变量方法</h3>

<p>注意：该用法会影响性能，推荐自定义命令</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>
</pre></div>

<pre><code>{{#each(x.slice(1))}}{{this}} {{/each}} // =&gt; 2 3
</code></pre>

<h3>
<a name="%E5%8F%98%E9%87%8F%E8%BF%90%E7%AE%97" class="anchor" href="#%E5%8F%98%E9%87%8F%E8%BF%90%E7%AE%97"><span class="octicon octicon-link"></span></a>变量运算</h3>

<p>支持 + - * / %</p>

<pre><code>{{x+y}}
{{x + "1"}}
{{ y - 1 }}
</code></pre>

<h3>
<a name="%E6%AF%94%E8%BE%83%E6%93%8D%E4%BD%9C" class="anchor" href="#%E6%AF%94%E8%BE%83%E6%93%8D%E4%BD%9C"><span class="octicon octicon-link"></span></a>比较操作</h3>

<p>支持 === !=== &gt; &gt;= &lt; &lt;=</p>

<pre><code>{{#if( x===1)}}
1
{{else}}
2
{{/if}}

{{#if ( (x+1) &gt; 2 )}}
{{/if}}
</code></pre>

<h3>
<a name="%E9%80%BB%E8%BE%91%E6%93%8D%E4%BD%9C" class="anchor" href="#%E9%80%BB%E8%BE%91%E6%93%8D%E4%BD%9C"><span class="octicon octicon-link"></span></a>逻辑操作</h3>

<p>支持 || &amp;&amp;</p>

<pre><code>{{#if(x&gt;1 &amp;&amp; y&lt;2)}}
{{/if}}
</code></pre>

<pre><code>{{#if(!x)}}
{{/if}}
</code></pre>

<h3>
<a name="%E5%BE%AA%E7%8E%AF" class="anchor" href="#%E5%BE%AA%E7%8E%AF"><span class="octicon octicon-link"></span></a>循环</h3>

<p>可以对数组或对象进行循环操作，默认获取循环对象值为 {{this}}，键为 {{xindex}} , 也可以指定.</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">];</span>
</pre></div>

<pre><code>{{#each(x)}}
{{xindex}} {{this}} // 0 a 1 b
{{/each}}

{{#each(x,"value","index")}}
{{key}} {{value}} // 0 a 1 b
{{/each}}
</code></pre>

<h3>
<a name="%E8%8C%83%E5%9B%B4%E5%BE%AA%E7%8E%AF" class="anchor" href="#%E8%8C%83%E5%9B%B4%E5%BE%AA%E7%8E%AF"><span class="octicon octicon-link"></span></a>范围循环</h3>

<p>可以对 start 和 end(不包含) 范围内的数字进行循环</p>

<pre><code>{{#each(range(0,3))}}{{this}}{{/each}} // 012
{{#each(range(3,0))}}{{this}}{{/each}} // 321
{{#each(range(3,0,2))}}{{this}}{{/each}} // 31
</code></pre>

<h3>
<a name="%E8%AE%BE%E7%BD%AE%E6%93%8D%E4%BD%9C" class="anchor" href="#%E8%AE%BE%E7%BD%AE%E6%93%8D%E4%BD%9C"><span class="octicon octicon-link"></span></a>设置操作</h3>

<pre><code>{{set(x=1)}}

{{x}} // 1
</code></pre>

<h3>
<a name="%E5%AE%8F" class="anchor" href="#%E5%AE%8F"><span class="octicon octicon-link"></span></a>宏</h3>

<pre><code>// 声明
{{#macro("test","param" default=1)}}param is {{param}} {{default}}{{/macro}}

// 调用宏
{{macro("test","2")}} // =&gt; param is 2 1

{{macro("test", "2", 2)}} // =&gt; param is 2 2
</code></pre>

<h3>
<a name="%E5%8C%85%E5%90%AB%E6%93%8D%E4%BD%9C" class="anchor" href="#%E5%8C%85%E5%90%AB%E6%93%8D%E4%BD%9C"><span class="octicon octicon-link"></span></a>包含操作</h3>

<p>x.xtpl:</p>

<pre><code>{{z}}
</code></pre>

<p>y.xtpl</p>

<pre><code>{{include("x")}}
</code></pre>

<h3>
<a name="%E7%BB%A7%E6%89%BF" class="anchor" href="#%E7%BB%A7%E6%89%BF"><span class="octicon octicon-link"></span></a>继承</h3>

<p>layout.xtpl</p>

<div class="highlight highlight-html"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"charset"</span> <span class="na">content=</span><span class="s">"utf-8"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;title&gt;</span>{{title}}<span class="nt">&lt;/title&gt;</span>
        {{{block ("head")}}} // 坑
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        {{{include ("./header")}}}
        {{{block ("body")}}}  // 坑
        {{{include ("./footer")}}}
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>

<p>index.xtpl</p>

<div class="highlight highlight-html"><pre>{{extend ("./layout1")}}

// 填
{{#block ("head")}}
    <span class="nt">&lt;link</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"test.css"</span> <span class="na">rev=</span><span class="s">"stylesheet"</span> <span class="na">rel=</span><span class="s">"stylesheet"</span><span class="nt">/&gt;</span>
{{/block}}

// 填
{{#block ("body")}}
    <span class="nt">&lt;h2&gt;</span>{{title}}<span class="nt">&lt;/h2&gt;</span>
{{/block}}
</pre></div>

<h3>
<a name="%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4" class="anchor" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4"><span class="octicon octicon-link"></span></a>自定义命令</h3>

<h4>
<a name="nodejs-%E5%85%A8%E5%B1%80%E5%91%BD%E4%BB%A4" class="anchor" href="#nodejs-%E5%85%A8%E5%B1%80%E5%91%BD%E4%BB%A4"><span class="octicon octicon-link"></span></a>nodejs 全局命令</h4>

<p>同步调用行内：</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">xtpl</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'xtpl'</span><span class="p">);</span>
<span class="nx">xtpl</span><span class="p">.</span><span class="nx">XTemplate</span><span class="p">.</span><span class="nx">addCommand</span><span class="p">(</span><span class="s1">'xInline'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">option</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">option</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">'1'</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<p>此时模板中可通过 {{}} 来转义命令返回的内容.</p>

<p>或使用 buffer (详见下面 Buffer api)</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">xtpl</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'xtpl'</span><span class="p">);</span>
<span class="nx">xtpl</span><span class="p">.</span><span class="nx">XTemplate</span><span class="p">.</span><span class="nx">addCommand</span><span class="p">(</span><span class="s1">'xInline'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">option</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">option</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">'1'</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<p>此时模板不能控制命令返回内容是否转义.</p>

<pre><code>{{xInline(1)}} // =&gt; 2
</code></pre>

<p>同步调用块级：</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">xtpl</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'xtpl'</span><span class="p">);</span>
<span class="nx">xtpl</span><span class="p">.</span><span class="nx">XTemplate</span><span class="p">.</span><span class="nx">addCommand</span><span class="p">(</span><span class="s1">'xBlock'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">option</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">option</span><span class="p">.</span><span class="nx">fn</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">)</span><span class="o">+</span><span class="nx">option</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">});</span>
</pre></div>

<pre><code>{{#xBlock(1)}}
2
{{/xBlock}}
// =&gt; 21
</code></pre>

<p>异步调用行内</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">xtpl</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'xtpl'</span><span class="p">);</span>
<span class="nx">xtpl</span><span class="p">.</span><span class="nx">XTemplate</span><span class="p">.</span><span class="nx">addCommand</span><span class="p">(</span><span class="s1">'xInline'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">option</span><span class="p">,</span><span class="nx">buffer</span><span class="p">){</span>
  <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">async</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">newBuffer</span><span class="p">){</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
        <span class="nx">newBuffer</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">option</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">).</span><span class="nx">end</span><span class="p">();</span>
    <span class="p">},</span><span class="mi">10</span><span class="p">);</span>
  <span class="p">});</span>
  <span class="k">return</span> <span class="nx">buffer</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<pre><code>{{xInline(1)}} // =&gt; 2
</code></pre>

<p>异步调用块级：</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">xtpl</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'xtpl'</span><span class="p">);</span>
<span class="nx">xtpl</span><span class="p">.</span><span class="nx">XTemplate</span><span class="p">.</span><span class="nx">addCommand</span><span class="p">(</span><span class="s1">'xInline'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">option</span><span class="p">,</span><span class="nx">buffer</span><span class="p">){</span>
  <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">async</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">newBuffer</span><span class="p">){</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">newScope</span> <span class="o">=</span> <span class="nx">xtpl</span><span class="p">.</span><span class="nx">XTemplate</span><span class="p">.</span><span class="nx">Scope</span><span class="p">({</span><span class="nx">ret</span><span class="o">:</span><span class="mi">2</span><span class="p">});</span>
        <span class="nx">newScope</span><span class="p">.</span><span class="nx">setParent</span><span class="p">(</span><span class="nx">scope</span><span class="p">);</span>
        <span class="nx">option</span><span class="p">.</span><span class="nx">fn</span><span class="p">(</span><span class="nx">newScope</span><span class="p">,</span> <span class="nx">newBuffer</span><span class="p">);</span>
    <span class="p">},</span><span class="mi">10</span><span class="p">);</span>
  <span class="p">});</span>
  <span class="nx">buffer</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">option</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
  <span class="k">return</span> <span class="nx">buffer</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>

<pre><code>{{#xBlock(1)}}
{{ret}}
{{/xBlock}}
// =&gt; 21
</code></pre>

<h4>
<a name="%E6%B5%8F%E8%A7%88%E5%99%A8%E5%91%BD%E4%BB%A4" class="anchor" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%91%BD%E4%BB%A4"><span class="octicon octicon-link"></span></a>浏览器命令</h4>

<p>全局：</p>

<div class="highlight highlight-javascript"><pre><span class="nx">KISSY</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'xtemplate/runtime'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">S</span><span class="p">,</span><span class="nx">XTemplate</span><span class="p">){</span>
    <span class="nx">XTemplate</span><span class="p">.</span><span class="nx">addCommand</span><span class="p">(...)</span> <span class="c1">// 同 node</span>
<span class="p">});</span>
</pre></div>

<p>局部：</p>

<div class="highlight highlight-javascript"><pre><span class="nx">KISSY</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'xtemplate/runtime'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">S</span><span class="p">,</span><span class="nx">XTemplate</span><span class="p">){</span>
    <span class="k">new</span> <span class="nx">XTemplate</span><span class="p">(</span><span class="s1">'{{x()}}'</span><span class="p">,{</span>
        <span class="nx">commands</span><span class="o">:</span><span class="p">{</span>
            <span class="nx">x</span><span class="o">:</span><span class="kd">function</span><span class="p">(){</span>
                <span class="c1">// ... 同 node</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">})...</span>
<span class="p">});</span>
</pre></div>

<h3>
<a name="buffer-api" class="anchor" href="#buffer-api"><span class="octicon octicon-link"></span></a>Buffer api</h3>

<h4>
<a name="methods-1" class="anchor" href="#methods-1"><span class="octicon octicon-link"></span></a>Methods</h4>

<p>Buffer write(data:String, escape:Boolean): 写数据到缓冲区</p>

<table>
<thead><tr>
<th>name</th>
        <th>type</th>
        <th>description</th>
    </tr></thead>
<tbody>
<tr>
<td>data</td>
        <td>String</td>
        <td>将要写到缓冲区的字符串</td>
    </tr>
<tr>
<td>escape</td>
            <td>Boolean</td>
            <td>是否转义</td>
        </tr>
</tbody>
</table><p>Buffer async(fn:Function): 产生新的异步缓冲区，新的缓冲区为 fn 回调函数的第一个参数</p>

<p>Buffer end(data, escape): 参数含义同 write 函数。 标志缓冲区数据填充完毕，用于通知异步缓冲区的结束。</p>

<p>Buffer error(reason): 触发 render 异步回调为失败。 reason 为回调的第一个参数.</p>

<h3>
<a name="scope-api" class="anchor" href="#scope-api"><span class="octicon octicon-link"></span></a>Scope api</h3>

<h4>
<a name="members" class="anchor" href="#members"><span class="octicon octicon-link"></span></a>Members</h4>

<p>parent: 上级作用域</p>

<p>root: 顶层作用域</p>

<h4>
<a name="methods-2" class="anchor" href="#methods-2"><span class="octicon octicon-link"></span></a>Methods</h4>

<p>void setParent(scope: Scope): 设置当前作用域的上级作用域</p>

<p>void setData(data): 设置当前作用域内数据</p>

<p>var getData(): 获取当前作用域内数据</p>

<p>void set(name,value): 设置当前作用域内附属数据</p>

<p>void get(name): 获取当前作用域内数据值（包括附属数据）</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/kissyteam/xtpl/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/kissyteam/xtpl/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/kissyteam/xtpl"></a> is maintained by <a href="https://github.com/kissyteam">kissyteam</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>